!function(n){"use strict";if("function"==typeof bootstrap)bootstrap("promise",n);else if("object"==typeof exports&&"object"==typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define(n);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=n}else{if("undefined"==typeof window&&"undefined"==typeof self)throw new Error("This environment was not anticipated by Q. Please file a bug.");var e="undefined"!=typeof window?window:self,t=e.Q;e.Q=n(),e.Q.noConflict=function(){return e.Q=t,this}}}(function(){"use strict";function n(n){return function(){return G.apply(n,arguments)}}function e(n){return n===Object(n)}function t(n){return"[object StopIteration]"===nn(n)||n instanceof U}function r(n,e){if(F&&e.stack&&"object"==typeof n&&null!==n&&n.stack){for(var t=[],r=e;r;r=r.source)r.stack&&(!n.__minimumStackCounter__||n.__minimumStackCounter__>r.stackCounter)&&(X(n,"__minimumStackCounter__",{value:r.stackCounter,configurable:!0}),t.unshift(r.stack));t.unshift(n.stack);X(n,"stack",{value:o(t.join("\n"+en+"\n")),configurable:!0})}}function o(n){for(var e=n.split("\n"),t=[],r=0;r<e.length;++r){var o=e[r];c(o)||i(o)||!o||t.push(o)}return t.join("\n")}function i(n){return n.indexOf("(module.js:")!==-1||n.indexOf("(node.js:")!==-1}function s(n){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(n);if(e)return[e[1],Number(e[2])];var t=/at ([^ ]+):(\d+):(?:\d+)$/.exec(n);if(t)return[t[1],Number(t[2])];var r=/.*@(.+):(\d+)$/.exec(n);return r?[r[1],Number(r[2])]:void 0}function c(n){var e=s(n);if(!e)return!1;var t=e[0],r=e[1];return t===L&&r>=M&&r<=an}function a(){if(F)try{throw new Error}catch(r){var n=r.stack.split("\n"),e=n[0].indexOf("@")>0?n[1]:n[2],t=s(e);if(!t)return;return L=t[0],t[1]}}function u(n){return n instanceof d?n:g(n)?q(n):O(n)}function f(){function n(n){e=n,u.longStackSupport&&F&&(i.source=n),z(t,function(e,t){u.nextTick(function(){n.promiseDispatch.apply(n,t)})},void 0),t=void 0,r=void 0}var e,t=[],r=[],o=W(f.prototype),i=W(d.prototype);if(i.promiseDispatch=function(n,o,i){var s=H(arguments);t?(t.push(s),"when"===o&&i[1]&&r.push(i[1])):u.nextTick(function(){e.promiseDispatch.apply(e,s)})},i.valueOf=function(){if(t)return i;var n=h(e);return v(n)&&(e=n),n},i.inspect=function(){return e?e.inspect():{state:"pending"}},u.longStackSupport&&F)try{throw new Error}catch(n){i.stack=n.stack.substring(n.stack.indexOf("\n")+1),i.stackCounter=tn++}return o.promise=i,o.resolve=function(t){e||n(u(t))},o.fulfill=function(t){e||n(O(t))},o.reject=function(t){e||n(S(t))},o.notify=function(n){e||z(r,function(e,t){u.nextTick(function(){t(n)})},void 0)},o}function p(n){if("function"!=typeof n)throw new TypeError("resolver must be a function.");var e=f();try{n(e.resolve,e.reject,e.notify)}catch(n){e.reject(n)}return e.promise}function l(n){return p(function(e,t){for(var r=0,o=n.length;r<o;r++)u(n[r]).then(e,t)})}function d(n,e,t){void 0===e&&(e=function(n){return S(new Error("Promise does not support operation: "+n))}),void 0===t&&(t=function(){return{state:"unknown"}});var r=W(d.prototype);if(r.promiseDispatch=function(t,o,i){var s;try{s=n[o]?n[o].apply(r,i):e.call(r,o,i)}catch(n){s=S(n)}t&&t(s)},r.inspect=t,t){var o=t();"rejected"===o.state&&(r.exception=o.reason),r.valueOf=function(){var n=t();return"pending"===n.state||"rejected"===n.state?r:n.value}}return r}function y(n,e,t,r){return u(n).then(e,t,r)}function h(n){if(v(n)){var e=n.inspect();if("fulfilled"===e.state)return e.value}return n}function v(n){return n instanceof d}function g(n){return e(n)&&"function"==typeof n.then}function m(n){return v(n)&&"pending"===n.inspect().state}function w(n){return!v(n)||"fulfilled"===n.inspect().state}function j(n){return v(n)&&"rejected"===n.inspect().state}function k(){rn.length=0,on.length=0,cn||(cn=!0)}function b(n,e){cn&&("object"==typeof process&&"function"==typeof process.emit&&u.nextTick.runAfter(function(){J(on,n)!==-1&&(process.emit("unhandledRejection",e,n),sn.push(n))}),on.push(n),e&&void 0!==e.stack?rn.push(e.stack):rn.push("(no stack) "+e))}function x(n){if(cn){var e=J(on,n);e!==-1&&("object"==typeof process&&"function"==typeof process.emit&&u.nextTick.runAfter(function(){var t=J(sn,n);t!==-1&&(process.emit("rejectionHandled",rn[e],n),sn.splice(t,1))}),on.splice(e,1),rn.splice(e,1))}}function S(n){var e=d({when:function(e){return e&&x(this),e?e(n):this}},function(){return this},function(){return{state:"rejected",reason:n}});return b(e,n),e}function O(n){return d({when:function(){return n},get:function(e){return n[e]},set:function(e,t){n[e]=t},delete:function(e){delete n[e]},post:function(e,t){return null===e||void 0===e?n.apply(void 0,t):n[e].apply(n,t)},apply:function(e,t){return n.apply(e,t)},keys:function(){return Z(n)}},void 0,function(){return{state:"fulfilled",value:n}})}function q(n){var e=f();return u.nextTick(function(){try{n.then(e.resolve,e.reject,e.notify)}catch(n){e.reject(n)}}),e.promise}function R(n){return d({isDef:function(){}},function(e,t){return P(n,e,t)},function(){return u(n).inspect()})}function T(n,e,t){return u(n).spread(e,t)}function Q(n){return function(){function e(n,e){var s;if("undefined"==typeof StopIteration){try{s=r[n](e)}catch(n){return S(n)}return s.done?u(s.value):y(s.value,o,i)}try{s=r[n](e)}catch(n){return t(n)?u(n.value):S(n)}return y(s,o,i)}var r=n.apply(this,arguments),o=e.bind(e,"next"),i=e.bind(e,"throw");return o()}}function _(n){u.done(u.async(n)())}function D(n){throw new U(n)}function E(n){return function(){return T([this,C(arguments)],function(e,t){return n.apply(e,t)})}}function P(n,e,t){return u(n).dispatch(e,t)}function C(n){return y(n,function(n){var e=0,t=f();return z(n,function(r,o,i){var s;v(o)&&"fulfilled"===(s=o.inspect()).state?n[i]=s.value:(++e,y(o,function(r){n[i]=r,0==--e&&t.resolve(n)},t.reject,function(n){t.notify({index:i,value:n})}))},void 0),0===e&&t.resolve(n),t.promise})}function A(n){if(0===n.length)return u.resolve();var e=u.defer(),t=0;return z(n,function(r,o,i){function s(n){e.resolve(n)}function c(n){0===--t&&(n.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+n.message,e.reject(n))}function a(n){e.notify({index:i,value:n})}var u=n[i];t++,y(u,s,c,a)},void 0),e.promise}function N(n){return y(n,function(n){return n=K(n,u),y(C(K(n,function(n){return y(n,$,$)})),function(){return n})})}function I(n){return u(n).allSettled()}function B(n,e){return u(n).then(void 0,void 0,e)}var F=!1;try{throw new Error}catch(n){F=!!n.stack}var L,U,M=a(),$=function(){},V=function(){function n(){for(var n,r;t.next;)t=t.next,n=t.task,t.task=void 0,r=t.domain,r&&(t.domain=void 0,r.enter()),e(n,r);for(;c.length;)n=c.pop(),e(n);o=!1}function e(e,t){try{e()}catch(e){if(s)throw t&&t.exit(),setTimeout(n,0),t&&t.enter(),e;setTimeout(function(){throw e},0)}t&&t.exit()}var t={task:void 0,next:null},r=t,o=!1,i=void 0,s=!1,c=[];if(V=function(n){r=r.next={task:n,domain:s&&process.domain,next:null},o||(o=!0,i())},"object"==typeof process&&"[object process]"===process.toString()&&process.nextTick)s=!0,i=function(){process.nextTick(n)};else if("function"==typeof setImmediate)i="undefined"!=typeof window?setImmediate.bind(window,n):function(){setImmediate(n)};else if("undefined"!=typeof MessageChannel){var a=new MessageChannel;a.port1.onmessage=function(){i=u,a.port1.onmessage=n,n()};var u=function(){a.port2.postMessage(0)};i=function(){setTimeout(n,0),u()}}else i=function(){setTimeout(n,0)};return V.runAfter=function(n){c.push(n),o||(o=!0,i())},V}(),G=Function.call,H=n(Array.prototype.slice),z=n(Array.prototype.reduce||function(n,e){var t=0,r=this.length;if(1===arguments.length)for(;;){if(t in this){e=this[t++];break}if(++t>=r)throw new TypeError}for(;t<r;t++)t in this&&(e=n(e,this[t],t));return e}),J=n(Array.prototype.indexOf||function(n){for(var e=0;e<this.length;e++)if(this[e]===n)return e;return-1}),K=n(Array.prototype.map||function(n,e){var t=this,r=[];return z(t,function(o,i,s){r.push(n.call(e,i,s,t))},void 0),r}),W=Object.create||function(n){function e(){}return e.prototype=n,new e},X=Object.defineProperty||function(n,e,t){return n[e]=t.value,n},Y=n(Object.prototype.hasOwnProperty),Z=Object.keys||function(n){var e=[];for(var t in n)Y(n,t)&&e.push(t);return e},nn=n(Object.prototype.toString);U="undefined"!=typeof ReturnValue?ReturnValue:function(n){this.value=n};var en="From previous event:";u.resolve=u,u.nextTick=V,u.longStackSupport=!1;var tn=1;"object"==typeof process&&process&&process.env&&process.env.Q_DEBUG&&(u.longStackSupport=!0),u.defer=f,f.prototype.makeNodeResolver=function(){var n=this;return function(e,t){e?n.reject(e):arguments.length>2?n.resolve(H(arguments,1)):n.resolve(t)}},u.Promise=p,u.promise=p,p.race=l,p.all=C,p.reject=S,p.resolve=u,u.passByCopy=function(n){return n},d.prototype.passByCopy=function(){return this},u.join=function(n,e){return u(n).join(e)},d.prototype.join=function(n){return u([this,n]).spread(function(n,e){if(n===e)return n;throw new Error("Q can't join: not the same: "+n+" "+e)})},u.race=l,d.prototype.race=function(){return this.then(u.race)},u.makePromise=d,d.prototype.toString=function(){return"[object Promise]"},d.prototype.then=function(n,e,t){function o(e){try{return"function"==typeof n?n(e):e}catch(n){return S(n)}}function i(n){if("function"==typeof e){r(n,c);try{return e(n)}catch(n){return S(n)}}return S(n)}function s(n){return"function"==typeof t?t(n):n}var c=this,a=f(),p=!1;return u.nextTick(function(){c.promiseDispatch(function(n){p||(p=!0,a.resolve(o(n)))},"when",[function(n){p||(p=!0,a.resolve(i(n)))}])}),c.promiseDispatch(void 0,"when",[void 0,function(n){var e,t=!1;try{e=s(n)}catch(n){if(t=!0,!u.onerror)throw n;u.onerror(n)}t||a.notify(e)}]),a.promise},u.tap=function(n,e){return u(n).tap(e)},d.prototype.tap=function(n){return n=u(n),this.then(function(e){return n.fcall(e).thenResolve(e)})},u.when=y,d.prototype.thenResolve=function(n){return this.then(function(){return n})},u.thenResolve=function(n,e){return u(n).thenResolve(e)},d.prototype.thenReject=function(n){return this.then(function(){throw n})},u.thenReject=function(n,e){return u(n).thenReject(e)},u.nearer=h,u.isPromise=v,u.isPromiseAlike=g,u.isPending=m,d.prototype.isPending=function(){return"pending"===this.inspect().state},u.isFulfilled=w,d.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},u.isRejected=j,d.prototype.isRejected=function(){return"rejected"===this.inspect().state};var rn=[],on=[],sn=[],cn=!0;u.resetUnhandledRejections=k,u.getUnhandledReasons=function(){return rn.slice()},u.stopUnhandledRejectionTracking=function(){k(),cn=!1},k(),u.reject=S,u.fulfill=O,u.master=R,u.spread=T,d.prototype.spread=function(n,e){return this.all().then(function(e){return n.apply(void 0,e)},e)},u.async=Q,u.spawn=_,u.return=D,u.promised=E,u.dispatch=P,d.prototype.dispatch=function(n,e){var t=this,r=f();return u.nextTick(function(){t.promiseDispatch(r.resolve,n,e)}),r.promise},u.get=function(n,e){return u(n).dispatch("get",[e])},d.prototype.get=function(n){return this.dispatch("get",[n])},u.set=function(n,e,t){return u(n).dispatch("set",[e,t])},d.prototype.set=function(n,e){return this.dispatch("set",[n,e])},u.del=u.delete=function(n,e){return u(n).dispatch("delete",[e])},d.prototype.del=d.prototype.delete=function(n){return this.dispatch("delete",[n])},u.mapply=u.post=function(n,e,t){return u(n).dispatch("post",[e,t])},d.prototype.mapply=d.prototype.post=function(n,e){return this.dispatch("post",[n,e])},u.send=u.mcall=u.invoke=function(n,e){return u(n).dispatch("post",[e,H(arguments,2)])},d.prototype.send=d.prototype.mcall=d.prototype.invoke=function(n){return this.dispatch("post",[n,H(arguments,1)])},u.fapply=function(n,e){return u(n).dispatch("apply",[void 0,e])},d.prototype.fapply=function(n){return this.dispatch("apply",[void 0,n])},u.try=u.fcall=function(n){return u(n).dispatch("apply",[void 0,H(arguments,1)])},d.prototype.fcall=function(){return this.dispatch("apply",[void 0,H(arguments)])},u.fbind=function(n){var e=u(n),t=H(arguments,1);return function(){return e.dispatch("apply",[this,t.concat(H(arguments))])}},d.prototype.fbind=function(){var n=this,e=H(arguments);return function(){return n.dispatch("apply",[this,e.concat(H(arguments))])}},u.keys=function(n){return u(n).dispatch("keys",[])},d.prototype.keys=function(){return this.dispatch("keys",[])},u.all=C,d.prototype.all=function(){return C(this)},u.any=A,d.prototype.any=function(){return A(this)},u.allResolved=function(n,e,t){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e+" is deprecated, use "+t+" instead.",new Error("").stack),n.apply(n,arguments)}}(N,"allResolved","allSettled"),d.prototype.allResolved=function(){return N(this)},u.allSettled=I,d.prototype.allSettled=function(){return this.then(function(n){return C(K(n,function(n){function e(){return n.inspect()}return n=u(n),n.then(e,e)}))})},u.fail=u.catch=function(n,e){return u(n).then(void 0,e)},d.prototype.fail=d.prototype.catch=function(n){return this.then(void 0,n)},u.progress=B,d.prototype.progress=function(n){return this.then(void 0,void 0,n)},u.fin=u.finally=function(n,e){return u(n).finally(e)},d.prototype.fin=d.prototype.finally=function(n){if(!n||"function"!=typeof n.apply)throw new Error("Q can't apply finally callback");return n=u(n),this.then(function(e){return n.fcall().then(function(){return e})},function(e){return n.fcall().then(function(){throw e})})},u.done=function(n,e,t,r){return u(n).done(e,t,r)},d.prototype.done=function(n,e,t){var o=function(n){u.nextTick(function(){if(r(n,i),!u.onerror)throw n;u.onerror(n)})},i=n||e||t?this.then(n,e,t):this;"object"==typeof process&&process&&process.domain&&(o=process.domain.bind(o)),i.then(void 0,o)};var an=a();return u});var Q=Q;if(!Q)throw new Error("async requires q.js");var async=function(){return String(window.location).indexOf("debug")!=-1&&(async.log=function(){var n=Array.prototype.slice.call(arguments);return n.unshift("async","--"),console.log.apply(console,n)}),arguments[0]&&arguments[0].substr?async.def.apply(this,arguments):async.obj.apply(this,arguments)};async.Q=Q,async.registry=function(n){var e,t,r;if(this.registry._||(this.registry.waiting={},this.registry._={}),2==arguments.length){if(!(t=async.registry.get(n)))throw new Error("missing base for "+n);if(!t.base)throw new Error("base property missing from base");n=arguments[1];for(e in n)Object.prototype.hasOwnProperty.call(n,e)&&(r=n[e],r.file&&(r.path=t.base+r.file),this.registry.add(e,r))}else if(Object.assign)Object.assign(this.registry._,n);else for(e in n)Object.prototype.hasOwnProperty.call(n,e)&&this.registry.add(e,n[e])},async.registry.get=function(n){return this._[n]||null},async.registry.add=function(n,e){if(this._[n]=e,async.log&&async.log("adding registry data for",n),this.waiting[n])for(var t=0,r=this.waiting[n].length;t<r;t++)this.waiting[n][t]()},async.obj=function(){async.log&&async.log("async.obj");var n,e,t,r,o=arguments,i={list:[],add:async.addScript,queue:async.queue,thens:[]};for(n=0,e=o.length;n<e&&(r=o[n]);n++)if(r.apply)i.thens.push(r);else if(!r.join&&!r.split&&isNaN(r))for(t in r)Object.prototype.hasOwnProperty.call(r,t)&&i.add(t,r[t]);for(i.queue(),n=0,e=i.thens.length;n<e&&(r=i.thens[n]);n++)i.q=i.q.spread(r);return i.q},async.def=function(n){async.log&&async.log("async.def",n);var e,t,r,o,i,s=arguments,c=async.storeOrReference(n);for(c.def=n,c.list=[],c.names=[],c.addScript=async.addScript,c.addDependency=async.addDependency,c.queue=async.queue,c.thens=[],Array.prototype.shift.call(s),e=0,t=s.length;e<t&&(o=s[e]);e++)if(o.apply)c.thens.push(o);else if(o.split)c.addDependency(o);else if(o.join)for(r=0;r<o.length;r++)i=async.registry.get(o[r]),i?c.addDependency(o[r],i):c.addDependency(o[r]);else for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&c.addDependency(r,o[r]);for(async.log&&async.log("async.def",c.def,"queue created from",c.list.length,"dependencies",c.names,c.list),c.queue(),c.q=c.q.tap(function(n){}),e=0,t=c.thens.length;e<t&&(o=c.thens[e]);e++)c.q=c.q.spread(o);return c.asynced&&(c.q=c.q.tap(function(){if(async.log){for(var n={},e=0;e<c.names.length;e++)n[c.names[e]]=async.storeOrReference(c.names[e]);async.log("resolving entire dependency chain for",c.def,"as",n)}c.dependencies.deferred.resolve.apply(c.dependencies.deferred,arguments)}),c.q=c.q.fail(function(n){c.dependencies.deferred.reject(n)})),async.log&&(c.q=c.q.tap(function(n){async.log("full completion for script",c.def,n)})),c.q},async.storeOrReference=function(n){var e;return async.store||(async.store={}),(e=async.store[n])?async.log&&async.log("referencing",n,e):(e=async.store[n]={},async.log&&async.log("storing",n)),e},async.addScript=function(n,e){var t,r,o,i=this.list;async.log&&async.log("adding script",n),o=async.storeOrReference(n),o.loading||(o.waiting||(t=r=async.load(),o.asynced=null,t=t.then(function(){return o.dependencies={deferred:Q.defer()},o.asynced?async.log&&async.log("waiting for deps",n):async.log&&async.log("not waiting for deps",n),o.asynced?o.dependencies.deferred.promise:null}),async.log&&(t=t.tap(function(){async.log("about to trigger the resolve for",n)})),t=t.then(function(){return o.resolve&&async.log&&async.log("resolving using function",n),o.resolve?o.resolve():arguments[0]}),async.log&&(t=t.tap(function(){async.log("resolved for",n,"as",Array.prototype.slice.call(arguments,0)),o.resolved=!0})),o.loader=t,o.originalLoader=r,i.push(t)),e?(e.asynced?(o.asynced=!0,o.resolve=e.resolve):(o.asynced=!1,o.resolve=e.resolve||async.resolver(n)),o.path=e.substr?e:e.path,o.waiting=!1,o.loading=!0,o.path?o.originalLoader.url(o.path):o.originalLoader.resolve()):o.waiting=!0)},async.addDependency=function(n,e){async.log&&async.log("adding dependency",n,"for",this.def);var t=this,r=async.storeOrReference(n);if(r.loader&&!r.waiting)this.list.push(r.q||r.loader),this.names.push(n);else if(e)if(e.join){this.names.push(n);for(var o=0;o<e.length;o++)this.addScript(e[o],e[o])}else this.addScript(n,e),this.names.push(n);else async.log&&async.log("waiting for dependency",n,"for",this.def),this.addScript(n),async.registry.waiting[n]||(async.registry.waiting[n]=[]),async.registry.waiting[n].push(function(){var e=async.registry.get(n);if(async.log&&async.log("waiting ended for dependency",n),!e)throw new Error("after waiting, data still not available for"+n);t.addDependency(n,e)})},async.queue=function(){return this.q=Q.all(this.list)},async.resolver=function(n){return function(){return function(){return this}()[n]}},async.load=function(n){var e=Q.defer(),t=e.promise;return t.resolve=function(){e.resolve()},t.reject=function(){e.reject()},t.url=function(n){var t=document.createElement("script");t.type="text/javascript",t.readyState?t.onreadystatechange=function(){"loaded"!=t.readyState&&"complete"!=t.readyState||(async.log&&async.log("script loaded (ie)",n),t.onreadystatechange=null,e.resolve())}:t.onload=function(){async.log&&async.log("script loaded",n),e.resolve()},t.src=n,document.getElementsByTagName("head")[0].appendChild(t),async.log&&async.log("injected script tag for",n)},n&&t.url(n),t};