!function(e){"use strict";if("function"==typeof bootstrap)bootstrap("promise",e);else if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=e}else{if("undefined"==typeof window&&"undefined"==typeof self)throw new Error("This environment was not anticipated by Q. Please file a bug.");var n="undefined"!=typeof window?window:self,t=n.Q;n.Q=e(),n.Q.noConflict=function(){return n.Q=t,this}}}(function(){"use strict";function e(e){return function(){return G.apply(e,arguments)}}function n(e){return e===Object(e)}function t(e){return"[object StopIteration]"===ee(e)||e instanceof U}function r(e,n){if(F&&n.stack&&"object"==typeof e&&null!==e&&e.stack){for(var t=[],r=n;r;r=r.source)r.stack&&(!e.__minimumStackCounter__||e.__minimumStackCounter__>r.stackCounter)&&(X(e,"__minimumStackCounter__",{value:r.stackCounter,configurable:!0}),t.unshift(r.stack));t.unshift(e.stack);X(e,"stack",{value:o(t.join("\n"+ne+"\n")),configurable:!0})}}function o(e){for(var n=e.split("\n"),t=[],r=0;r<n.length;++r){var o=n[r];c(o)||i(o)||!o||t.push(o)}return t.join("\n")}function i(e){return e.indexOf("(module.js:")!==-1||e.indexOf("(node.js:")!==-1}function s(e){var n=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(n)return[n[1],Number(n[2])];var t=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(t)return[t[1],Number(t[2])];var r=/.*@(.+):(\d+)$/.exec(e);return r?[r[1],Number(r[2])]:void 0}function c(e){var n=s(e);if(!n)return!1;var t=n[0],r=n[1];return t===L&&r>=M&&r<=ce}function a(){if(F)try{throw new Error}catch(r){var e=r.stack.split("\n"),n=e[0].indexOf("@")>0?e[1]:e[2],t=s(n);if(!t)return;return L=t[0],t[1]}}function u(e){return e instanceof d?e:v(e)?O(e):q(e)}function f(){function e(e){n=e,u.longStackSupport&&F&&(i.source=e),z(t,function(n,t){u.nextTick(function(){e.promiseDispatch.apply(e,t)})},void 0),t=void 0,r=void 0}var n,t=[],r=[],o=W(f.prototype),i=W(d.prototype);if(i.promiseDispatch=function(e,o,i){var s=H(arguments);t?(t.push(s),"when"===o&&i[1]&&r.push(i[1])):u.nextTick(function(){n.promiseDispatch.apply(n,s)})},i.valueOf=function(){if(t)return i;var e=h(n);return g(e)&&(n=e),e},i.inspect=function(){return n?n.inspect():{state:"pending"}},u.longStackSupport&&F)try{throw new Error}catch(e){i.stack=e.stack.substring(e.stack.indexOf("\n")+1),i.stackCounter=te++}return o.promise=i,o.resolve=function(t){n||e(u(t))},o.fulfill=function(t){n||e(q(t))},o.reject=function(t){n||e(S(t))},o.notify=function(e){n||z(r,function(n,t){u.nextTick(function(){t(e)})},void 0)},o}function p(e){if("function"!=typeof e)throw new TypeError("resolver must be a function.");var n=f();try{e(n.resolve,n.reject,n.notify)}catch(e){n.reject(e)}return n.promise}function l(e){return p(function(n,t){for(var r=0,o=e.length;r<o;r++)u(e[r]).then(n,t)})}function d(e,n,t){void 0===n&&(n=function(e){return S(new Error("Promise does not support operation: "+e))}),void 0===t&&(t=function(){return{state:"unknown"}});var r=W(d.prototype);if(r.promiseDispatch=function(t,o,i){var s;try{s=e[o]?e[o].apply(r,i):n.call(r,o,i)}catch(e){s=S(e)}t&&t(s)},r.inspect=t,t){var o=t();"rejected"===o.state&&(r.exception=o.reason),r.valueOf=function(){var e=t();return"pending"===e.state||"rejected"===e.state?r:e.value}}return r}function y(e,n,t,r){return u(e).then(n,t,r)}function h(e){if(g(e)){var n=e.inspect();if("fulfilled"===n.state)return n.value}return e}function g(e){return e instanceof d}function v(e){return n(e)&&"function"==typeof e.then}function m(e){return g(e)&&"pending"===e.inspect().state}function w(e){return!g(e)||"fulfilled"===e.inspect().state}function j(e){return g(e)&&"rejected"===e.inspect().state}function k(){re.length=0,oe.length=0,se||(se=!0)}function b(e,n){se&&("object"==typeof process&&"function"==typeof process.emit&&u.nextTick.runAfter(function(){J(oe,e)!==-1&&(process.emit("unhandledRejection",n,e),ie.push(e))}),oe.push(e),n&&void 0!==n.stack?re.push(n.stack):re.push("(no stack) "+n))}function x(e){if(se){var n=J(oe,e);n!==-1&&("object"==typeof process&&"function"==typeof process.emit&&u.nextTick.runAfter(function(){var t=J(ie,e);t!==-1&&(process.emit("rejectionHandled",re[n],e),ie.splice(t,1))}),oe.splice(n,1),re.splice(n,1))}}function S(e){var n=d({when:function(n){return n&&x(this),n?n(e):this}},function(){return this},function(){return{state:"rejected",reason:e}});return b(n,e),n}function q(e){return d({when:function(){return e},get:function(n){return e[n]},set:function(n,t){e[n]=t},delete:function(n){delete e[n]},post:function(n,t){return null===n||void 0===n?e.apply(void 0,t):e[n].apply(e,t)},apply:function(n,t){return e.apply(n,t)},keys:function(){return Z(e)}},void 0,function(){return{state:"fulfilled",value:e}})}function O(e){var n=f();return u.nextTick(function(){try{e.then(n.resolve,n.reject,n.notify)}catch(e){n.reject(e)}}),n.promise}function R(e){return d({isDef:function(){}},function(n,t){return Q(e,n,t)},function(){return u(e).inspect()})}function T(e,n,t){return u(e).spread(n,t)}function E(e){return function(){function n(e,n){var s;if("undefined"==typeof StopIteration){try{s=r[e](n)}catch(e){return S(e)}return s.done?u(s.value):y(s.value,o,i)}try{s=r[e](n)}catch(e){return t(e)?u(e.value):S(e)}return y(s,o,i)}var r=e.apply(this,arguments),o=n.bind(n,"next"),i=n.bind(n,"throw");return o()}}function _(e){u.done(u.async(e)())}function D(e){throw new U(e)}function P(e){return function(){return T([this,A(arguments)],function(n,t){return e.apply(n,t)})}}function Q(e,n,t){return u(e).dispatch(n,t)}function A(e){return y(e,function(e){var n=0,t=f();return z(e,function(r,o,i){var s;g(o)&&"fulfilled"===(s=o.inspect()).state?e[i]=s.value:(++n,y(o,function(r){e[i]=r,0==--n&&t.resolve(e)},t.reject,function(e){t.notify({index:i,value:e})}))},void 0),0===n&&t.resolve(e),t.promise})}function C(e){if(0===e.length)return u.resolve();var n=u.defer(),t=0;return z(e,function(r,o,i){function s(e){n.resolve(e)}function c(e){0===--t&&(e.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+e.message,n.reject(e))}function a(e){n.notify({index:i,value:e})}var u=e[i];t++,y(u,s,c,a)},void 0),n.promise}function N(e){return y(e,function(e){return e=K(e,u),y(A(K(e,function(e){return y(e,$,$)})),function(){return e})})}function B(e){return u(e).allSettled()}function I(e,n){return u(e).then(void 0,void 0,n)}var F=!1;try{throw new Error}catch(e){F=!!e.stack}var L,U,M=a(),$=function(){},V=function(){function e(){for(var e,r;t.next;)t=t.next,e=t.task,t.task=void 0,r=t.domain,r&&(t.domain=void 0,r.enter()),n(e,r);for(;c.length;)e=c.pop(),n(e);o=!1}function n(n,t){try{n()}catch(n){if(s)throw t&&t.exit(),setTimeout(e,0),t&&t.enter(),n;setTimeout(function(){throw n},0)}t&&t.exit()}var t={task:void 0,next:null},r=t,o=!1,i=void 0,s=!1,c=[];if(V=function(e){r=r.next={task:e,domain:s&&process.domain,next:null},o||(o=!0,i())},"object"==typeof process&&"[object process]"===process.toString()&&process.nextTick)s=!0,i=function(){process.nextTick(e)};else if("function"==typeof setImmediate)i="undefined"!=typeof window?setImmediate.bind(window,e):function(){setImmediate(e)};else if("undefined"!=typeof MessageChannel){var a=new MessageChannel;a.port1.onmessage=function(){i=u,a.port1.onmessage=e,e()};var u=function(){a.port2.postMessage(0)};i=function(){setTimeout(e,0),u()}}else i=function(){setTimeout(e,0)};return V.runAfter=function(e){c.push(e),o||(o=!0,i())},V}(),G=Function.call,H=e(Array.prototype.slice),z=e(Array.prototype.reduce||function(e,n){var t=0,r=this.length;if(1===arguments.length)for(;;){if(t in this){n=this[t++];break}if(++t>=r)throw new TypeError}for(;t<r;t++)t in this&&(n=e(n,this[t],t));return n}),J=e(Array.prototype.indexOf||function(e){for(var n=0;n<this.length;n++)if(this[n]===e)return n;return-1}),K=e(Array.prototype.map||function(e,n){var t=this,r=[];return z(t,function(o,i,s){r.push(e.call(n,i,s,t))},void 0),r}),W=Object.create||function(e){function n(){}return n.prototype=e,new n},X=Object.defineProperty||function(e,n,t){return e[n]=t.value,e},Y=e(Object.prototype.hasOwnProperty),Z=Object.keys||function(e){var n=[];for(var t in e)Y(e,t)&&n.push(t);return n},ee=e(Object.prototype.toString);U="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e};var ne="From previous event:";u.resolve=u,u.nextTick=V,u.longStackSupport=!1;var te=1;"object"==typeof process&&process&&process.env&&process.env.Q_DEBUG&&(u.longStackSupport=!0),u.defer=f,f.prototype.makeNodeResolver=function(){var e=this;return function(n,t){n?e.reject(n):arguments.length>2?e.resolve(H(arguments,1)):e.resolve(t)}},u.Promise=p,u.promise=p,p.race=l,p.all=A,p.reject=S,p.resolve=u,u.passByCopy=function(e){return e},d.prototype.passByCopy=function(){return this},u.join=function(e,n){return u(e).join(n)},d.prototype.join=function(e){return u([this,e]).spread(function(e,n){if(e===n)return e;throw new Error("Q can't join: not the same: "+e+" "+n)})},u.race=l,d.prototype.race=function(){return this.then(u.race)},u.makePromise=d,d.prototype.toString=function(){return"[object Promise]"},d.prototype.then=function(e,n,t){function o(n){try{return"function"==typeof e?e(n):n}catch(e){return S(e)}}function i(e){if("function"==typeof n){r(e,c);try{return n(e)}catch(e){return S(e)}}return S(e)}function s(e){return"function"==typeof t?t(e):e}var c=this,a=f(),p=!1;return u.nextTick(function(){c.promiseDispatch(function(e){p||(p=!0,a.resolve(o(e)))},"when",[function(e){p||(p=!0,a.resolve(i(e)))}])}),c.promiseDispatch(void 0,"when",[void 0,function(e){var n,t=!1;try{n=s(e)}catch(e){if(t=!0,!u.onerror)throw e;u.onerror(e)}t||a.notify(n)}]),a.promise},u.tap=function(e,n){return u(e).tap(n)},d.prototype.tap=function(e){return e=u(e),this.then(function(n){return e.fcall(n).thenResolve(n)})},u.when=y,d.prototype.thenResolve=function(e){return this.then(function(){return e})},u.thenResolve=function(e,n){return u(e).thenResolve(n)},d.prototype.thenReject=function(e){return this.then(function(){throw e})},u.thenReject=function(e,n){return u(e).thenReject(n)},u.nearer=h,u.isPromise=g,u.isPromiseAlike=v,u.isPending=m,d.prototype.isPending=function(){return"pending"===this.inspect().state},u.isFulfilled=w,d.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},u.isRejected=j,d.prototype.isRejected=function(){return"rejected"===this.inspect().state};var re=[],oe=[],ie=[],se=!0;u.resetUnhandledRejections=k,u.getUnhandledReasons=function(){return re.slice()},u.stopUnhandledRejectionTracking=function(){k(),se=!1},k(),u.reject=S,u.fulfill=q,u.master=R,u.spread=T,d.prototype.spread=function(e,n){return this.all().then(function(n){return e.apply(void 0,n)},n)},u.async=E,u.spawn=_,u.return=D,u.promised=P,u.dispatch=Q,d.prototype.dispatch=function(e,n){var t=this,r=f();return u.nextTick(function(){t.promiseDispatch(r.resolve,e,n)}),r.promise},u.get=function(e,n){return u(e).dispatch("get",[n])},d.prototype.get=function(e){return this.dispatch("get",[e])},u.set=function(e,n,t){return u(e).dispatch("set",[n,t])},d.prototype.set=function(e,n){return this.dispatch("set",[e,n])},u.del=u.delete=function(e,n){return u(e).dispatch("delete",[n])},d.prototype.del=d.prototype.delete=function(e){return this.dispatch("delete",[e])},u.mapply=u.post=function(e,n,t){return u(e).dispatch("post",[n,t])},d.prototype.mapply=d.prototype.post=function(e,n){return this.dispatch("post",[e,n])},u.send=u.mcall=u.invoke=function(e,n){return u(e).dispatch("post",[n,H(arguments,2)])},d.prototype.send=d.prototype.mcall=d.prototype.invoke=function(e){return this.dispatch("post",[e,H(arguments,1)])},u.fapply=function(e,n){return u(e).dispatch("apply",[void 0,n])},d.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},u.try=u.fcall=function(e){return u(e).dispatch("apply",[void 0,H(arguments,1)])},d.prototype.fcall=function(){return this.dispatch("apply",[void 0,H(arguments)])},u.fbind=function(e){var n=u(e),t=H(arguments,1);return function(){return n.dispatch("apply",[this,t.concat(H(arguments))])}},d.prototype.fbind=function(){var e=this,n=H(arguments);return function(){return e.dispatch("apply",[this,n.concat(H(arguments))])}},u.keys=function(e){return u(e).dispatch("keys",[])},d.prototype.keys=function(){return this.dispatch("keys",[])},u.all=A,d.prototype.all=function(){return A(this)},u.any=C,d.prototype.any=function(){return C(this)},u.allResolved=function(e,n,t){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(n+" is deprecated, use "+t+" instead.",new Error("").stack),e.apply(e,arguments)}}(N,"allResolved","allSettled"),d.prototype.allResolved=function(){return N(this)},u.allSettled=B,d.prototype.allSettled=function(){return this.then(function(e){return A(K(e,function(e){function n(){return e.inspect()}return e=u(e),e.then(n,n)}))})},u.fail=u.catch=function(e,n){return u(e).then(void 0,n)},d.prototype.fail=d.prototype.catch=function(e){return this.then(void 0,e)},u.progress=I,d.prototype.progress=function(e){return this.then(void 0,void 0,e)},u.fin=u.finally=function(e,n){return u(e).finally(n)},d.prototype.fin=d.prototype.finally=function(e){if(!e||"function"!=typeof e.apply)throw new Error("Q can't apply finally callback");return e=u(e),this.then(function(n){return e.fcall().then(function(){return n})},function(n){return e.fcall().then(function(){throw n})})},u.done=function(e,n,t,r){return u(e).done(n,t,r)},d.prototype.done=function(e,n,t){var o=function(e){u.nextTick(function(){if(r(e,i),!u.onerror)throw e;u.onerror(e)})},i=e||n||t?this.then(e,n,t):this;"object"==typeof process&&process&&process.domain&&(o=process.domain.bind(o)),i.then(void 0,o)};var ce=a();return u});var Q=Q;if(!Q)throw new Error("async requires q.js");var module=module||{};module.exports=module.exports||{};var async=function(){return String(window.location).indexOf("debug")!=-1&&(async.log=function(){var e=Array.prototype.slice.call(arguments);return e.unshift("async","--"),console.log.apply(console,e)}),arguments[0]&&arguments[0].substr?async.def.apply(this,arguments):async.obj.apply(this,arguments)};async.tmp={},async.promiser=Q,async.registry=function(e){var n,t,r;if(this.registry._||(this.registry.waiting={},this.registry._={}),2==arguments.length){if(!(t=async.registry.get(e)))throw new Error("missing base for "+e);if(!t.base)throw new Error("base property missing from base");if(e=arguments[1],t.use){if(!e[t.use])throw new Error("unimplemented use value "+t.use);e=e[t.use]}for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r=e[n],r.file&&(r.path=t.base+r.file),this.registry.add(n,r))}else if(Object.assign)Object.assign(this.registry._,e);else for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&this.registry.add(n,e[n])},async.registry.get=function(e){return this._[e]||null},async.registry.add=function(e,n){if(this._[e]=n,async.log&&async.log("adding registry data for",e),this.waiting[e])for(var t=0,r=this.waiting[e].length;t<r;t++)this.waiting[e][t]()},async.obj=function(){async.log&&async.log("async.obj");var e,n,t,r,o=arguments,i={list:[],add:async.addScript,queue:async.queue,thens:[]};for(e=0,n=o.length;e<n&&(r=o[e]);e++)if(r.apply)i.thens.push(r);else if(!r.join&&!r.split&&isNaN(r))for(t in r)Object.prototype.hasOwnProperty.call(r,t)&&i.add(t,r[t]);for(i.queue(),e=0,n=i.thens.length;e<n&&(r=i.thens[e]);e++)i.q=i.q.spread(r);return i.q},async.def=function(e){async.log&&async.log("async.def",e);var n,t,r,o,i,s=arguments,c=async.storeOrReference(e);for(c.def=e,c.list=[],c.names=[],c.asynced=!0,c.addScript=async.addScript,c.addDependency=async.addDependency,c.queue=async.queue,c.thens=[],c.added||(c.defBeforeAdded=!0),Array.prototype.shift.call(s),n=0,t=s.length;n<t&&(o=s[n]);n++)if(o.apply)c.thens.push(o);else if(o.split)c.addDependency(o);else if(o.join)for(r=0;r<o.length;r++)i=async.registry.get(o[r]),i?c.addDependency(o[r],i):c.addDependency(o[r]);else for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&c.addDependency(r,o[r]);for(async.log&&async.log("async.def",c.def,"queue created from",c.list.length,"dependencies",c.names,c.list),c.queue(),n=0,t=c.thens.length;n<t&&(o=c.thens[n]);n++)c.q=c.q.spread(o);return c.q=c.q.tap(function(){if(c.dependencies){if(async.log){for(var e={},n=0;n<c.names.length;n++)e[c.names[n]]=async.storeOrReference(c.names[n]);async.log("resolving entire dependency chain for",c.def,"as",e)}c.dependencies.deferred.notify(arguments),c.dependencies.deferred.resolve.apply(c.dependencies.deferred,arguments)}}),c.q=c.q.fail(function(e){throw c.dependencies&&(c.dependencies.deferred.notify("rejected"),c.dependencies.deferred.reject(e)),e}),async.log&&(c.q=c.q.tap(function(e){async.log("full completion for script",c.def,e)})),c.q},async.ref=function(e,n,t){return async.ref.list||(async.ref.list={}),(void 0===async.ref.list[e]||t)&&(async.ref.list[e]=n),async.ref.list[e]||n},async.storeOrReference=function(e){var n;return async.store||(async.store={}),(n=async.store[e])?async.log&&async.log("referencing",e,n):(n=async.store[e]={},async.log&&async.log("storing",e)),n},async.addScript=function(e,n){var t,r,o,i=this.list;async.log&&async.log("adding/referencing script",e),o=async.storeOrReference(e),o.added=!0,o.loading||(n&&(n.asynced?(o.asynced=!0,o.resolve=n.resolve):(o.asynced=!1,o.resolve=n.resolve||async.resolver(e)),o.path=n.substr?n:n.path),o.waiting||(t=r=async.load(),t=t.then(function(){return o.defBeforeAdded?(async.log&&async.log("not waiting (2) for dependencies for",e),null):o.asynced?(async.log&&async.log("waiting for dependencies for",e),o.dependencies={deferred:async.promiser.defer()},o.dependencies.deferred.promise):(async.log&&async.log("not waiting for dependencies for",e),null)}),async.log&&(t=t.tap(function(){async.log("about to trigger the resolve for",e)})),t=t.then(function(){return o.resolve?async.log&&async.log("resolving using function",e):async.log&&async.log("resolving using return value",e),o.resolve?o.resolve():arguments[0]}),t=t.tap(function(n){async.log&&async.log("resolved for",e,"as",Array.prototype.slice.call(arguments,0)),o.resolved=!0,async.ref(e,n,!0)}),o.loader=t,o.originalLoader=r,i.push(o.q||t)),n?(o.waiting=!1,o.loading=!0,o.path?o.originalLoader.url(o.path):(async.log&&async.log("no path so auto-resolving",e),o.originalLoader.resolve())):o.waiting=!0)},async.addDependency=function(e,n){var t=this,r=async.storeOrReference(e);if(r.loader&&!r.waiting){if(this.q)return void(async.log&&async.log("queue already created, cannot update dependency (1)",e,"for",this.def));async.log&&async.log("adding dependency (1)",e,"for",this.def),this.list.push(r.q||r.loader),this.names.push(e)}else if(n)if(async.log&&async.log("adding dependency (2)",e,"for",this.def),n.join){!this.q&&this.names.push(e);for(var o=0;o<n.length;o++)this.addScript(n[o],n[o])}else this.addScript(e,n),!this.q&&this.names.push(e);else r.waiting?(async.log&&async.log("already waiting for dependency",e,"for",this.def),this.list.push(r.q||r.loader)):(async.log&&async.log("waiting for dependency",e,"for",this.def),this.addScript(e)),async.registry.waiting[e]||(async.registry.waiting[e]=[]),async.registry.waiting[e].push(function(){var n=async.registry.get(e);if(async.log&&async.log("waiting ended for dependency",e),!n)throw new Error("after waiting, data still not available for"+e);t.addDependency(e,n)})},async.queue=function(){return this.q=async.promiser.all(this.list)},async.resolver=function(e){return function(){return function(){return this}()[e]}},async.load=function(e){var n=async.promiser.defer(),t=n.promise;return t.resolve=function(){async.log&&async.log("script resolved"),n.resolve()},t.reject=function(){async.log&&async.log("script rejected"),n.reject()},t.url=function(e){var t=document.createElement("script");t.type="text/javascript",t.readyState?t.onreadystatechange=function(){"loaded"!=t.readyState&&"complete"!=t.readyState||(async.log&&async.log("script loaded (ie)",e),t.onreadystatechange=null,n.resolve())}:t.onload=function(){async.log&&async.log("script loaded",e),n.resolve()},t.src=e,document.getElementsByTagName("head")[0].appendChild(t),async.log&&async.log("injected script tag for",e)},e&&t.url(e),t};