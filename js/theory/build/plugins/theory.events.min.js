async("theory.plugins.events",["theory"],function(t){t=t||{};return t.plugins=t.plugins||{},t.plugins.events=function(e){return t.base.mix(e||{},{prep:function(){return this.i={},this.i.listeners={},this.i.context=this,this},context:function(t){this.i.context=t},triggerEach:function(t){if(this.i.listeners[t])for(var e=0,n=this.i.listeners[t],i=n.length;e<i;e++)n[e].apply(this.i.context);return this},trigger:function(t){t=this.splitNames(t);for(var e=0;e<t.length;e++)this.triggerEach(t[e]);return this},onEach:function(t,e){return this.i.listeners[t]||(this.i.listeners[t]=[]),this.i.listeners[t].push(e),this},on:function(t,e){t=this.splitNames(t);for(var n=0;n<t.length;n++)this.onEach(t[n],e);return this},offEach:function(){if(this.i.listeners[name]){var t=this.i.listeners[name].indexOf(callback);t!==-1&&this.i.listeners[name].splice(t,1)}return this},off:function(){names=this.splitNames(names);for(var t=0;t<names.length;t++)this.offEach(names[t],callback);return this},splitNames:function(t){return t.split(" ")},triggerEvent:function(t,e,n,i){var s,r;r=document.createEvent?document.createEvent("HTMLEvents"):document.createEventObject(),r.initEvent?r.initEvent(e.type,n,i):r.eventType=e.type;for(s in e)"type"!=s&&(r[s]=e[s]);t.dispatchEvent?t.dispatchEvent(r):t.fireEvent("on"+r.eventType,r)}})}(t.plugins.events||{}),t.plugins.events});