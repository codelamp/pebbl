<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Pebbl â€” Convert Hull to Poly</title>
</head>
<body>
<div id="log"></div>
<textarea id="template" style="display: none;">
{
  "shapes": [
    {
      "flats": {{flats}},
      "points": {{points}}
    }
  ]
}
</textarea>
<textarea id="textarea" style="width: 1000px; height: 200px;">(63.233000000000004, -777.5)  , (93.233000000000004, -773.5)  , (171.733, -693)  , (176.733, -518)  , (240.733, -513)  , (260.733, -497)  , (259.733, -457)  , (325.233, -451.5)  , (357.733, -405)  , (330.733, -190)  , (215.233, -175.5)  , (186.233, -183.5)  , (178.233, -83.5)  , (156.733, -68)  , (111.233, -65.5)  , (84.233000000000004, -32.5)  , (4.2330000000000041, -0.5)  , (-189.767, -42.5)  , (-202.267, -66)  , (-205.267, -116)  , (-305.767, -139.5)  , (-366.267, -354)  , (-356.267, -399)  , (-285.767, -517.5)  , (-280.267, -526)  , (-259.767, -526.5)  , (-262.267, -662)  , (-246.267, -696)  , (-192.767, -728.5)  , (-107.767, -757.5)  , (-22.766999999999996, -773.5)  , (62.233000000000004, -777.5)</textarea>
<textarea id="output" style="width: 1000px; height: 400px;"></textarea>
<script>
var ta = document.getElementById('textarea');
var tpl = document.getElementById('template').value;
var blur = function(){
  var v = this.value.replace(/\(/gi, 'obj(');
  var obj = function(x,y){return {x:x, y:y}};
  v = eval('[' + v + ']');
  document.getElementById('output').value = tpl.replace('{{flats}}', JSON.stringify(flat(v))).replace('{{points}}', JSON.stringify(v));
};
var flat = function(a){
  var b = [];
  for ( var i=0; i<a.length; i++ ) {
    b.push(a[i].x);
    b.push(a[i].y);
  }
  return b;
};
ta.onblur = blur;
blur();
</script>
</body>
</html>