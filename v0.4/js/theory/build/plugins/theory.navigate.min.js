async("theory.plugins.navigate",["theory","theory.is"],function(e,t){var r=e=e||{};e.plugins=e.plugins||{},e.plugins.navigate=function(i){return e.base.mix(i||{},{theory:{prep:function(){this.shared.empty=this.create()}},shared:{simpleSelector:/^[a-z0-9 _.-]+$|^\*$/i,lispSelector:/^\(\$\w+/i,segmentedSelector:/\//,endsWithSelector:/(^[^\/]+\$$)|(^\*[^\/]+$)/,startsWithSelector:/(^\^[^\/]+$)|(^[^\/]+\*$)/,empty:null},i:{hasChildren:function(e){for(var t in e)return!0;return!1},children:function(e,r){return t.literalObject(e)&&Object.values(e,r)||[]},hasParent:function(e){return!(!e||!e.parent)},parent:function(e,t){return e.parent?e.parent.call?[e.parent()]:[e.parent]:[]},needsResolving:function(e){return!1},resolve:function(e){return r.promise().resolve(e)}},configuration:function(e){return e&&(e.hasChildren&&(this.i.hasChildren=e.hasChildren),e.children&&(this.i.children=e.children),e.hasParent&&(this.i.hasParent=e.hasParent),e.parent&&(this.i.parent=e.parent),e.needsResolving&&(this.i.needsResolving=e.needsResolving),e.resolve&&(this.i.resolve=e.resolve)),this},create:function(e,t){var r=this.prep.apply(Object.create(this),arguments);return r.i.memories=Object.create(this.i.memories||{}),r},prep:function(e,t){return this.i=Object.create(this.i),this.i.targets=[],e&&t&&t.parents&&(e=this.applyParents(e)),e&&this.i.targets.push(e),this},applyParents:function(e,i,n,s){if(n||(n=0),i||(i=100),n>i)return e;if(!e||e.parent)return e;if(t.primitive(e))e=r.promotePrimitive(e),s&&(e.parent=s);else{s&&(e.parent=s);var h,a=this.createParentRef(e);for(h in e)"parent"===h||Object.prototype.hasOwnProperty&&!Object.prototype.hasOwnProperty.call(e,h)||(e[h]=this.applyParents(e[h],i,n+1,a))}return e},createParentRef:function(e){return function(){return e}},pushStack:function(e){for(var t,r=0,i=e,n=i.length;r<n;r++)(t=i[r])&&(this.i.targets.push(t),this.i.needsResolving(t)&&(this.i.resolving||(this.i.resolving=[]),this.i.resolving[r]=this.i.resolve(t)));return this},children:function(e){for(var t=this.create(),r=0,i=this.i.targets,n=i.length;r<n;r++)t.pushStack(this.i.children(i[r],e));return t},each:function(e){for(var t,r=0,i=this.i.targets,n=i.length;r<n;r++)t=i[r],t&&t.original&&(t=t.original),e&&e.call&&e.call(this,t,r);return this},rem:function(e){return e=e||"default",this.i.memories[e]=this,this},rec:function(e){return e=e||"default",this.i.memories&&this.i.memories[e]?this.i.memories[e]:null},parent:function(e){for(var t=this.create(),r=0,i=this.i.targets,n=i.length;r<n;r++)t.pushStack(this.i.parent(i[r],e));return t},getKeys:function(){for(var e=[],t=0,r=this.i.targets,i=r.length;t<i;t++)e=e.concat(Object.keys(r[t]));return e},select:function(e,i){var n=this.shared.empty;if(t.literalObject(e)&&e.type)switch(e.type){case"segment":n=this.select(e.string,e)}else{if(""===e||this.shared.simpleSelector.test(e)){switch(e){case"":return this;case"*":n=this.children();break;case"..":n=this.parent();break;default:n=this.children(e)}return n}if(this.shared.startsWithSelector.test(e)){if(e=e.indexOf("*")!==-1?e.substring(0,e.length-1):"^"===e.charAt(0)?e.substring(1,e.length):null)return this.children(function(t,r){return 0===t.indexOf(e)})}else if(this.shared.endsWithSelector.test(e)){if(e="*"===e.charAt(0)?e.substring(1,e.length):e.indexOf("$")!==-1?e.substring(0,e.length-1):null)return this.children(function(t,r){return 0===t.indexOf(e)})}else if(this.shared.lispSelector.test(e)){var s,h,a,l=r.step(i,"children",0,"children",0);switch(l.type){case"spaces":if(a=l&&l.children)return s=r.opn.wrap(a.shift()).string(),h=r.step(r.internal.object,"selectors",s),h?(a=r.opn.wrap(a).strings(),h.apply(this,a)):r.error(Error("Unknown selector function "+s))}}else{for(var c,o=r.opn(e),u=o.segments(),p=this;+p&&(c=u.next());)p=p.select(c);n=p}}return n},get:function(){return this.i.targets},valueOf:function(){return this.i.targets.length?1:0}})}(e.plugins.navigate||{}),r.internal.object.selectors.$wildcardKey=r.method({method:function(){console.log(this,arguments)}}),r.internal.object.selectors.$keyContains=r.method({method:function(e){return this.children(function(t,r){return t.indexOf(e)!==-1})}})});